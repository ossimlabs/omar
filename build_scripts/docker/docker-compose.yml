version: '2'
services:
  o2-web-proxy:
    build: ./o2-web-proxy
    container_name: o2-web-proxy
    image: ossimlabs/o2-web-proxy
    ports:
      - "80:80"
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
  o2-base:
    build: ./o2-base
    container_name: o2-base
    image: ossimlabs/o2-base
  o2-db:
    build: ./o2-db
    container_name: o2-db
    environment:
      POSTGRES_USER: postgres_user
      POSTGRES_PASSWORD: abc123
      POSTGRES_DB: omar_prod
    ports:
      - "4990:5432"
    image: ossimlabs/o2-db
  o2-wms:
    build: ./o2-wms
    container_name: o2-wms
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "4997:8080"
    links:
      - o2-db
    image: ossimlabs/o2-wms
    depends_on:
      - o2-base
      - o2-db
      - o2-stager
  o2-wfs:
    build: ./o2-wfs
    container_name: o2-wfs
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
    ports:
      - "4998:8080"
    links:
      - o2-db
    image: ossimlabs/o2-wfs
    depends_on:
      - o2-base
      - o2-db
      - o2-stager
  o2-wcs:
    build: ./o2-wcs
    container_name: o2-wcs
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5013:8080"
    links:
      - o2-db
    image: ossimlabs/o2-wcs
    depends_on:
      - o2-base
      - o2-db
      - o2-stager
  o2-wmts:
    build: ./o2-wmts
    container_name: o2-wmts
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      WFSSERVER: docker.local
      WFSPORT: :4997
      WMSSERVER: docker.local
      WMSPORT: :4998
    ports:
      - "4999:8080"
    links:
      - o2-db
    image: ossimlabs/o2-wmts
    depends_on:
      - o2-base
      - o2-db
  o2-sqs:
    build: ./o2-sqs
    container_name: o2-sqs
    environment:
      AWSDNS: sqs.us-east-1.amazonaws.com
      AWSQUEUEPATH: 320588532383/avro-tst
      WAIT_TIME_SECONDS: 20
      NUMBER_OF_MESSAGES: 1
      POLLING_INTERVAL_SECONDS: 10
      DESTINATION_TYPE: stdout
      DESTINATION_POST_END_POINT: o2-avro
      DESTINATION_POST_END_POINT_PORT: :8080
      DESTINATION_POST_FIELD: message
    volumes:
      # Modify the path below to reflect your
      # AWS credentials location. Example:
      #- /Users/jdoe/.aws:/root/.aws
      - /Users/<username>/.aws:/root/.aws
    ports:
      - "5000:8080"
    image: ossimlabs/o2-sqs
    depends_on:
      - o2-base
      - o2-stager
      - o2-avro
  o2-avro:
    build: ./o2-avro
    container_name: o2-avro
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      ADDRASTERENDPOINTURL: o2-stager
      ADDRASTERENDPOINTPORT: :8080
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5001:8080"
    links:
      - o2-db
    image: ossimlabs/o2-avro
    depends_on:
      - o2-base
      - o2-db
      - o2-stager
  o2-stager:
    build: ./o2-stager
    container_name: o2-stager
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5002:8080"
    links:
      - o2-db
    image: ossimlabs/o2-stager
    depends_on:
      - o2-base
      - o2-db
  o2-jpip:
    build: ./o2-jpip
    container_name: o2-jpip
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      JPIPCACHEDIR: /data/jpip-cache
      JPIPSERVERURL: docker.local
      JPIPSERVERPORT: :5004
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5003:8080"
    image: ossimlabs/o2-jpip
    depends_on:
      - o2-base
  o2-jpip-server:
    build: ./o2-jpip-server
    container_name: o2-jpip-server
    environment:
      JPIPCACHEDIR: /data/jpip-cache
      JPIPSERVERURL: localhost
      JPIPSERVERPORT: 8080
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5004:8080"
    image: ossimlabs/o2-jpip-server
    depends_on:
      - o2-base
  o2-superoverlay:
    build: ./o2-superoverlay
    container_name: o2-superoverlay
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      WMSURL: docker.local
      WMSPORT: 4997
    ports:
      - "5009:8080"
    image: ossimlabs/o2-superoverlay
    depends_on:
      - o2-base
  o2-download:
    build: ./o2-download
    container_name: o2-download
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
    volumes:
      # Mount the the host local data directory to the container
      - /Users/Shared/data:/data
    ports:
      - "5011:8080"
    image: ossimlabs/o2-download
    depends_on:
      - o2-base
  o2-swipe:
    build: ./o2-swipe
    container_name: o2-swipe
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      WFSURL: docker.local
      WFSPORT: 4998
      WMSURL: docker.local
      WMSPORT: 4997
    ports:
      - "5012:8080"
    image: ossimlabs/o2-swipe
    depends_on:
      - o2-base
      - o2-db
      - o2-stager
  o2-twofishes:
    build: ./twofishes
    container_name: twofishes
    ports:
      - "5006:8081"
    image: ossimlabs/twofishes
  o2-omar:
    build: ./o2-omar
    container_name: o2-omar
    environment:
      DBHOST: o2-db
      DBPORT: :5432
      DBNAME: omar_prod
      DBUSER: postgres_user
      DBPASS: abc123
      WFSURL: 192.168.99.100/o2-wfs
      #WFSPORT:
      WMSURL: 192.168.99.100/o2-wms
      #WMSPORT:
      STAGERURL: docker.local
      STAGERPORT: 5002
      DOWNLOADURL: 192.168.99.100/o2-download
      DOWNLOADPORT:
      KMLURL: 192.168.99.100/o2-superoverlay
      KMLPORT:
      PREDIOURL: docker.local
      PREDIOPORT: 9999
      PREDIOENABLED: "false"
      TWOFISHURL: 192.168.99.100/twofishes
      TWOFISHPORT:
      SWIPEURL: docker.local
      SWIPEPORT: 9999
      SWIPEENABLED: "false"
      JPIPURL: docker.local
      JPIPPORT: 9999
      JPIPENABLED: "false"
      WMTSURL: docker.local
      WMTSPORT: 4999
      WMTSENABLED: "true"
      PWIKURL: docker.local
      PWIKPORT: 9999
      PWIKENABLED: "false"
      APIURL: docker.local
      APIPORT: 9999
      APIENABLED: "false"
      BANNERCOLOR: green
      BANNERCLASSIFICATION: Unclassified
    ports:
      - "5010:8080"
    links:
      - o2-db
    image: ossimlabs/o2-omar
    depends_on:
      - o2-base
      - o2-db
      - o2-wms
      - o2-wfs
      - o2-stager
